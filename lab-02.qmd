---
title: "Lab 2 - Data wrangling"
author: "Ayden Frost"
date: "February 12, 2026"
format: pdf
---

```{r}
#| eval: true
#| message: false

library(tidyverse)
```

# Questions

## Part 1

### Question 1

```{r}
midwest |>
  count(state, sort = TRUE)
```

Illinois has the highest number of counties with 102, while Wisconsin has the lowest number of counties with only 72.

\newpage

### Question 2

```{r}
midwest |>
  count(county, state) |>
  count(county, name = "nstates") |>
  filter(nstates == 5)
```

\newpage

### Question 3

```{r}
midwest |>
  filter(popdensity > 25000) |>
  select(county, state, popdensity, poptotal, area) |>
  arrange(desc(popdensity))
```

```{r}
midwest |>
  filter(popdensity == max(popdensity)) |>
  select(county, state, popdensity, poptotal, area)
```

\newpage

### Question 4

```{r}
midwest |>
  summarize(
    median(popdensity),
    q1 = quantile(popdensity, 0.25),
    q3 = quantile(popdensity, 0.75)
  )
```

The distribution of population density of counties is unimodal and extremely right-skewed. A typical Midwestern county has population density of 1156 people per unit area. The middle 50% of the counties have population densities between 622 to 2330 people per unit area.

\newpage

### Question 5

```{r}
midwest |>
  count(state, inmetro) |>
  group_by(state) |>
  mutate(prop = n / sum(n))
```

\newpage

### Question 6

```{r}
midwest |>
  filter(percbelowpoverty >= 40,
         percollege <= 10) |>
  select(county, state,
         percbelowpoverty,
         percollege)
```

\newpage

```{r}
midwest |>
  filter(percollege >= 40,
         percbelowpoverty <= 20) |>
  select(county, state,
         percbelowpoverty,
         percollege)
```

\newpage

```{r}
midwest |>
  filter(
    (percbelowpoverty >= 40 & percollege <= 10) |
    (percbelowpoverty <= 20 & percollege >= 40)
  ) |>
  select(county, state,
         percbelowpoverty,
         percollege)
```

\newpage

```{r}
midwest |>
  mutate(
    potential_outlier = if_else(
    (percbelowpoverty >= 40 & percollege <= 10) |
    (percbelowpoverty <= 20 & percollege >= 40),
      "Yes",
      "No"
    )
  ) |>
  select(county, state,
         percbelowpoverty,
         percollege,
         potential_outlier) |>
  arrange(potential_outlier)
```

\newpage

```{r}
midwest |> 
  mutate(
  potential_outlier = if_else (
(percbelowpoverty >= 40 & percollege <= 10) | 
(percbelowpoverty <= 20 & percollege >= 40),
"Yes",
"No")) |>
ggplot (aes (x = percollege, y = percbelowpoverty, colour = potential_outlier, shape = state)) +
geom_point() +
  labs (
  x= "% college educated",
  y = "% below poverty",
  colour = "Potential Outlier",
  shape = "The state the county is in",
  title = "Percentage with a College degree versus poverty rate",
  subtitle = "by State in the Midwest")

```

\newpage

### Question 7

```{r}
  state_population <- midwest |>
  group_by(state) |>
  summarize(total_population = sum(poptotal)) |>
  arrange(desc(total_population))
state_population
```

\newpage

```{r}
state_population |>
  mutate(
    population_prop = total_population / sum(total_population)
  ) |>
  arrange(desc(population_prop))
```

Illinois is the most populated with 27% of the Midwestern population living there.

\newpage

### Question 8

\newpage

## Part 2

### Question 9
